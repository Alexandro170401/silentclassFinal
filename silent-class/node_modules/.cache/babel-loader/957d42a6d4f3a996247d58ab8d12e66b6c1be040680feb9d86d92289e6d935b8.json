{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import'./Examen.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Examen(){const{id}=useParams();const[preguntas,setPreguntas]=useState([]);const[respuestas,setRespuestas]=useState({});const[curso,setCurso]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const navigate=useNavigate();useEffect(()=>{fetchPreguntas();fetchCurso();},[id]);const fetchPreguntas=async()=>{try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/examen.php?cursoId=\").concat(id));if(!response.ok){throw new Error('Error al obtener las preguntas del examen');}const data=await response.json();setPreguntas(data.preguntas||[]);setLoading(false);}catch(error){console.error('Error fetching exam questions:',error);setError('Error al cargar las preguntas del examen');setLoading(false);}};const fetchCurso=async()=>{try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/courses.php?id=\").concat(id));if(!response.ok){throw new Error('Error al obtener los detalles del curso');}const data=await response.json();setCurso(data);}catch(error){console.error('Error fetching course details:',error);setError('Error al cargar los detalles del curso');}};const handleOpcionChange=(preguntaId,opcionId)=>{setRespuestas({...respuestas,[preguntaId]:opcionId+1});};const handleSubmit=async()=>{const usuarioId=localStorage.getItem('usuarioId');if(!usuarioId){console.error('Usuario no identificado');return;}const data={cursoId:id,usuarioId,respuestas,fecha:new Date().toISOString()};console.log('Datos enviados al backend:',data);try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/evaluarExamen.php\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});if(response.ok){const result=await response.json();// Muestra el mensaje de éxito\nalert(\"Curso culminado exitosamente.\\nEntrega de la nota y del curso recomendado.\");// Navega a la página de evaluación después de mostrar el mensaje\nnavigate(\"/evaluacion/\".concat(result.evaluacionId,\"?nombreCurso=\").concat(encodeURIComponent(curso.nombre),\"&especialidad=\").concat(encodeURIComponent(curso.especialidad)));}else{console.error('Error en la evaluación del examen');}}catch(error){console.error('Error en el envío del examen:',error);}};if(loading){return/*#__PURE__*/_jsx(\"p\",{children:\"Cargando...\"});}if(error){return/*#__PURE__*/_jsx(\"p\",{children:error});}if(!preguntas||preguntas.length===0){return/*#__PURE__*/_jsx(\"p\",{children:\"No hay preguntas disponibles para este examen.\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"examen-container\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Examen del Curso \",curso&&curso.nombre]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[preguntas.map((pregunta,indexPregunta)=>/*#__PURE__*/_jsxs(\"div\",{className:\"pregunta\",children:[/*#__PURE__*/_jsx(\"h3\",{children:pregunta.pregunta}),/*#__PURE__*/_jsx(\"div\",{className:\"opciones\",children:pregunta.opciones.map((opcion,indexOpcion)=>/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[opcion,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"radio\",name:\"pregunta-\".concat(indexPregunta),value:indexOpcion+1,checked:respuestas[pregunta.id]===indexOpcion+1,onChange:()=>handleOpcionChange(pregunta.id,indexOpcion)})]})},indexOpcion))})]},indexPregunta)),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleSubmit,className:\"submit-examen-button\",children:\"Enviar Examen\"})]})]});}export default Examen;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","Examen","id","preguntas","setPreguntas","respuestas","setRespuestas","curso","setCurso","loading","setLoading","error","setError","navigate","fetchPreguntas","fetchCurso","response","fetch","concat","process","env","REACT_APP_API_URL","ok","Error","data","json","console","handleOpcionChange","preguntaId","opcionId","handleSubmit","usuarioId","localStorage","getItem","cursoId","fecha","Date","toISOString","log","method","headers","body","JSON","stringify","result","alert","evaluacionId","encodeURIComponent","nombre","especialidad","children","length","className","onSubmit","map","pregunta","indexPregunta","opciones","opcion","indexOpcion","type","name","value","checked","onChange","onClick"],"sources":["C:/Users/HP/Desktop/Proyecto_Alexandro/Version hibrida (local-web)/silent-class/src/components/Examen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom'; \r\nimport './Examen.css';\r\n\r\nfunction Examen() {\r\n  const { id } = useParams();\r\n  const [preguntas, setPreguntas] = useState([]);\r\n  const [respuestas, setRespuestas] = useState({});\r\n  const [curso, setCurso] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    fetchPreguntas();\r\n    fetchCurso();\r\n  }, [id]);\r\n\r\n  const fetchPreguntas = async () => {\r\n    try {\r\n      const response = await fetch(`${process.env.REACT_APP_API_URL}/api/examen.php?cursoId=${id}`);\r\n      if (!response.ok) {\r\n        throw new Error('Error al obtener las preguntas del examen');\r\n      }\r\n      const data = await response.json();\r\n      setPreguntas(data.preguntas || []);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      console.error('Error fetching exam questions:', error);\r\n      setError('Error al cargar las preguntas del examen');\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchCurso = async () => {\r\n    try {\r\n      const response = await fetch(`${process.env.REACT_APP_API_URL}/api/courses.php?id=${id}`);\r\n      if (!response.ok) {\r\n        throw new Error('Error al obtener los detalles del curso');\r\n      }\r\n      const data = await response.json();\r\n      setCurso(data);\r\n    } catch (error) {\r\n      console.error('Error fetching course details:', error);\r\n      setError('Error al cargar los detalles del curso');\r\n    }\r\n  };\r\n\r\n  const handleOpcionChange = (preguntaId, opcionId) => {\r\n    setRespuestas({\r\n      ...respuestas,\r\n      [preguntaId]: opcionId + 1,\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    const usuarioId = localStorage.getItem('usuarioId');\r\n    \r\n    if (!usuarioId) {\r\n      console.error('Usuario no identificado');\r\n      return;\r\n    }\r\n  \r\n    const data = {\r\n      cursoId: id,\r\n      usuarioId,\r\n      respuestas,\r\n      fecha: new Date().toISOString(),\r\n    };\r\n  \r\n    console.log('Datos enviados al backend:', data);\r\n  \r\n    try {\r\n      const response = await fetch(`${process.env.REACT_APP_API_URL}/api/evaluarExamen.php`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(data),\r\n      });\r\n  \r\n      if (response.ok) {\r\n        const result = await response.json();\r\n\r\n        // Muestra el mensaje de éxito\r\n        alert(\"Curso culminado exitosamente.\\nEntrega de la nota y del curso recomendado.\");\r\n        \r\n        // Navega a la página de evaluación después de mostrar el mensaje\r\n        navigate(`/evaluacion/${result.evaluacionId}?nombreCurso=${encodeURIComponent(curso.nombre)}&especialidad=${encodeURIComponent(curso.especialidad)}`);\r\n      } else {\r\n        console.error('Error en la evaluación del examen');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error en el envío del examen:', error);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return <p>Cargando...</p>;\r\n  }\r\n\r\n  if (error) {\r\n    return <p>{error}</p>;\r\n  }\r\n\r\n  if (!preguntas || preguntas.length === 0) {\r\n    return <p>No hay preguntas disponibles para este examen.</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"examen-container\">\r\n      <h2>Examen del Curso {curso && curso.nombre}</h2>\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        {preguntas.map((pregunta, indexPregunta) => (\r\n          <div key={indexPregunta} className=\"pregunta\">\r\n            <h3>{pregunta.pregunta}</h3>\r\n            <div className=\"opciones\">\r\n              {pregunta.opciones.map((opcion, indexOpcion) => (\r\n                <div key={indexOpcion}>\r\n                  <label>\r\n                    {opcion}\r\n                    <br />\r\n                    <input\r\n                      type=\"radio\"\r\n                      name={`pregunta-${indexPregunta}`}\r\n                      value={indexOpcion + 1}\r\n                      checked={respuestas[pregunta.id] === indexOpcion + 1}\r\n                      onChange={() => handleOpcionChange(pregunta.id, indexOpcion)}\r\n                    />\r\n                  </label>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        ))}\r\n        <button type=\"button\" onClick={handleSubmit} className=\"submit-examen-button\">\r\n          Enviar Examen\r\n        </button>\r\n      </form>\r\n      \r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Examen;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}