{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';// Importa useNavigate\nimport'./Auth.css';// Asegúrate de tener el archivo CSS\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Registro(){const navigate=useNavigate();// Inicializa useNavigate para redirigir\n// Estado del formulario\nconst[formData,setFormData]=useState({tipousuario:'',nombre:'',apellido_paterno:'',apellido_materno:'',dni:'',correo:'',contrasena:''});const[estudiantes,setEstudiantes]=useState([]);// Estado para la lista de estudiantes\nconst[selectedEstudiante,setSelectedEstudiante]=useState('');// Estado para el estudiante seleccionado\n// Manejar cambios en el formulario\nconst handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};// Manejar el cambio del tipo de usuario\nconst handleTipoUsuarioChange=e=>{setFormData({...formData,tipousuario:e.target.value});// Si el tipo de usuario es 'Padre', cargamos la lista de estudiantes\nif(e.target.value==='Padre'){axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/get_estudiantes.php\"))// Aquí haces la llamada al backend para obtener los estudiantes\n.then(response=>{console.log(response.data);// Verifica los datos en la consola\nsetEstudiantes(response.data);// Cargar estudiantes al estado\n}).catch(error=>{console.error('Error al obtener los estudiantes:',error);});}};// Manejar el cambio del estudiante seleccionado\nconst handleEstudianteChange=e=>{setSelectedEstudiante(e.target.value);};// Manejar el envío del formulario\nconst handleSubmit=async e=>{e.preventDefault();const dataToSend={...formData,id_estudiante:formData.tipousuario==='Padre'?selectedEstudiante:null// Solo enviar id_estudiante si es 'Padre'\n};console.log(\"Datos que se envían al backend:\",dataToSend);// Verifica los datos que se envían\ntry{const response=await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/registro.php\"),dataToSend);console.log('Usuario registrado:',response.data);// Manejar redirección o mensaje de éxito aquí\n// Redirigir a la página de inicio (o la que prefieras) después del registro exitoso\nalert('¡Registro exitoso! Serás redirigido a la página de inicio.');navigate('/');// Aquí lo rediriges a la página de inicio. Puedes cambiar '/' por la ruta que desees.\n}catch(error){var _error$response;console.error('Error al registrar el usuario:',((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);// Verifica el error\n}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Registro\"}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Nombre:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"nombre\",value:formData.nombre,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Apellido Paterno:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"apellido_paterno\",value:formData.apellido_paterno,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Apellido Materno:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"apellido_materno\",value:formData.apellido_materno,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"DNI:\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"dni\",value:formData.dni,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Correo:\",/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"correo\",value:formData.correo,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Contrase\\xF1a:\",/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"contrasena\",value:formData.contrasena,onChange:handleChange,required:true})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"Tipo de Usuario:\",/*#__PURE__*/_jsxs(\"select\",{name:\"tipousuario\",value:formData.tipousuario,onChange:handleTipoUsuarioChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Docente\",children:\"Docente\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Estudiante\",children:\"Estudiante\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Padre\",children:\"Padre o Apoderado\"})]})]}),formData.tipousuario==='Padre'&&/*#__PURE__*/_jsxs(\"label\",{children:[\"Estudiante Relacionado:\",/*#__PURE__*/_jsxs(\"select\",{value:selectedEstudiante,onChange:handleEstudianteChange,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Seleccionar Estudiante\"}),estudiantes.map(estudiante=>/*#__PURE__*/_jsxs(\"option\",{value:estudiante.id,children:[estudiante.nombreCompleto||'Nombre no disponible',\" \"]},estudiante.id))]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Registrarse\"})]});}export default Registro;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Registro","navigate","formData","setFormData","tipousuario","nombre","apellido_paterno","apellido_materno","dni","correo","contrasena","estudiantes","setEstudiantes","selectedEstudiante","setSelectedEstudiante","handleChange","e","target","name","value","handleTipoUsuarioChange","get","concat","process","env","REACT_APP_API_URL","then","response","console","log","data","catch","error","handleEstudianteChange","handleSubmit","preventDefault","dataToSend","id_estudiante","post","alert","_error$response","message","onSubmit","children","type","onChange","required","map","estudiante","id","nombreCompleto"],"sources":["C:/Users/HP/Desktop/Proyecto_Alexandro/Version hibrida (local-web)/silent-class/src/components/Signup.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';  // Importa useNavigate\r\nimport './Auth.css';  // Asegúrate de tener el archivo CSS\r\n\r\nfunction Registro() {\r\n  const navigate = useNavigate();  // Inicializa useNavigate para redirigir\r\n\r\n  // Estado del formulario\r\n  const [formData, setFormData] = useState({\r\n    tipousuario: '',\r\n    nombre: '',\r\n    apellido_paterno: '',\r\n    apellido_materno: '',\r\n    dni: '',\r\n    correo: '',\r\n    contrasena: ''\r\n  });\r\n\r\n  const [estudiantes, setEstudiantes] = useState([]); // Estado para la lista de estudiantes\r\n  const [selectedEstudiante, setSelectedEstudiante] = useState(''); // Estado para el estudiante seleccionado\r\n\r\n  // Manejar cambios en el formulario\r\n  const handleChange = (e) => {\r\n    setFormData({\r\n      ...formData,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n\r\n  // Manejar el cambio del tipo de usuario\r\n  const handleTipoUsuarioChange = (e) => {\r\n    setFormData({\r\n      ...formData,\r\n      tipousuario: e.target.value,\r\n    });\r\n\r\n    // Si el tipo de usuario es 'Padre', cargamos la lista de estudiantes\r\n    if (e.target.value === 'Padre') {\r\n      axios.get(`${process.env.REACT_APP_API_URL}/api/get_estudiantes.php`) // Aquí haces la llamada al backend para obtener los estudiantes\r\n        .then(response => {\r\n          console.log(response.data);  // Verifica los datos en la consola\r\n          setEstudiantes(response.data);  // Cargar estudiantes al estado\r\n        })\r\n        .catch(error => {\r\n          console.error('Error al obtener los estudiantes:', error);\r\n        });\r\n    }\r\n  };\r\n\r\n  // Manejar el cambio del estudiante seleccionado\r\n  const handleEstudianteChange = (e) => {\r\n    setSelectedEstudiante(e.target.value);\r\n  };\r\n\r\n  // Manejar el envío del formulario\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    const dataToSend = {\r\n      ...formData,\r\n      id_estudiante: formData.tipousuario === 'Padre' ? selectedEstudiante : null  // Solo enviar id_estudiante si es 'Padre'\r\n    };\r\n\r\n    console.log(\"Datos que se envían al backend:\", dataToSend);  // Verifica los datos que se envían\r\n\r\n    try {\r\n      const response = await axios.post(`${process.env.REACT_APP_API_URL}/api/registro.php`, dataToSend);\r\n      console.log('Usuario registrado:', response.data);\r\n      // Manejar redirección o mensaje de éxito aquí\r\n      // Redirigir a la página de inicio (o la que prefieras) después del registro exitoso\r\n      alert('¡Registro exitoso! Serás redirigido a la página de inicio.');\r\n      navigate('/');  // Aquí lo rediriges a la página de inicio. Puedes cambiar '/' por la ruta que desees.\r\n    } catch (error) {\r\n      console.error('Error al registrar el usuario:', error.response?.data || error.message);  // Verifica el error\r\n    }\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit}>\r\n      <h2>Registro</h2>\r\n\r\n      <label>\r\n        Nombre:\r\n        <input type=\"text\" name=\"nombre\" value={formData.nombre} onChange={handleChange} required />\r\n      </label>\r\n\r\n      <label>\r\n        Apellido Paterno:\r\n        <input type=\"text\" name=\"apellido_paterno\" value={formData.apellido_paterno} onChange={handleChange} required />\r\n      </label>\r\n\r\n      <label>\r\n        Apellido Materno:\r\n        <input type=\"text\" name=\"apellido_materno\" value={formData.apellido_materno} onChange={handleChange} />\r\n      </label>\r\n\r\n      <label>\r\n        DNI:\r\n        <input type=\"text\" name=\"dni\" value={formData.dni} onChange={handleChange} required />\r\n      </label>\r\n\r\n      <label>\r\n        Correo:\r\n        <input type=\"email\" name=\"correo\" value={formData.correo} onChange={handleChange} required />\r\n      </label>\r\n\r\n      <label>\r\n        Contraseña:\r\n        <input type=\"password\" name=\"contrasena\" value={formData.contrasena} onChange={handleChange} required />\r\n      </label>\r\n\r\n      <label>\r\n        Tipo de Usuario:\r\n        <select name=\"tipousuario\" value={formData.tipousuario} onChange={handleTipoUsuarioChange} required>\r\n          <option value=\"\">Seleccionar</option>\r\n          <option value=\"Docente\">Docente</option>\r\n          <option value=\"Estudiante\">Estudiante</option>\r\n          <option value=\"Padre\">Padre o Apoderado</option>\r\n        </select>\r\n      </label>\r\n\r\n      {/* Mostrar el selector de estudiantes solo si el tipo de usuario es 'Padre' */}\r\n      {formData.tipousuario === 'Padre' && (\r\n        <label>\r\n          Estudiante Relacionado:\r\n          <select value={selectedEstudiante} onChange={handleEstudianteChange} required>\r\n            <option value=\"\">Seleccionar Estudiante</option>\r\n            {estudiantes.map(estudiante => (\r\n              <option key={estudiante.id} value={estudiante.id}>\r\n                {estudiante.nombreCompleto || 'Nombre no disponible'} {/* Mostrar algo por defecto si nombreCompleto es null */}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </label>\r\n      )}\r\n\r\n      <button type=\"submit\">Registrarse</button>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default Registro;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}